!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((t||self).fragments={})}(this,function(t){var i=function(t,i,e){var n=t.createShader(e);if(t.shaderSource(n,i),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS)){var o=t.getShaderInfoLog(n);return console.error("Error compiling shader",n,o),t.deleteShader(n),null}return n},e=function(){function t(t,e){this.attributes={},this.uniforms={},this.program=function(t,e,n){var o=i(t,"\nattribute vec2 position;\nvoid main() {\n    gl_Position = vec4(position, 0.0, 1.0);\n}",t.VERTEX_SHADER),r=i(t,"\nprecision highp float;\n\nuniform float uTime;\nuniform vec2 uResolution;\nuniform vec2 uMouse;\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy / uResolution.xy;\n    gl_FragColor = vec4(uv, 0.5 + 0.5 * cos(uTime), 1.0);\n}",t.FRAGMENT_SHADER),s=t.createProgram();return t.attachShader(s,o),t.attachShader(s,r),t.linkProgram(s),s}(t)}var e=t.prototype;return e.getAttribute=function(t,i){return this.attributes[i]||(this.attributes[i]=t.getAttribLocation(this.program,i)),this.attributes[i]},e.getUniform=function(t,i){return this.uniforms[i]||(this.uniforms[i]=t.getUniformLocation(this.program,i)),this.uniforms[i]},e.setU1f=function(t,i,e){t.uniform1f(this.getUniform(t,i),e)},e.setU2f=function(t,i,e,n){t.uniform2f(this.getUniform(t,i),e,n)},e.setU2fv=function(t,i,e){t.uniform2fv(this.getUniform(t,i),e)},e.setU1i=function(t,i,e){t.uniform1i(this.getUniform(t,i),e)},t}();t.Renderer=function(){function t(){var t=this;this.onBlur=function(){t.pause=!0},this.onFocus=function(){t.pause=!1},this.onMove=function(i){t.mouse[0]=i.clientX,t.mouse[1]=i.clientY},this.width=320,this.height=240,this.fragments=[],this.mouse=new Float32Array(2),this.ready=!1,this.pause=!1,this.now=Date.now(),window.WebGLRenderingContext?this.init():console.error("Your browser doesn't support WebGL")}var i=t.prototype;return i.useFragment=function(t){this.gl.useProgram(t.program),this.gl.enableVertexAttribArray(t.getAttribute(this.gl,"position")),this.gl.vertexAttribPointer(t.getAttribute(this.gl,"position"),2,this.gl.FLOAT,!1,0,0),t.setU2f(this.gl,"uResolution",this.width,this.height),t.setU1f(this.gl,"uTime",(Date.now()-this.now)/1e3),t.setU2fv(this.gl,"uMouse",this.mouse)},i.init=function(){var t=document.createElement("canvas");t.width=this.width,t.height=this.height,document.body.appendChild(t),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),window.addEventListener("mousemove",this.onMove),this.gl=t.getContext("webgl"),this.gl.getExtension("OES_texture_float"),this.gl.getExtension("OES_standard_derivatives"),this.gl.getExtension("OES_float_linear"),this.gl.getExtension("OES_half_float_linear"),this.gl||console.error("Couldn't start WebGL. Try get.webgl.org/troubleshooting");var i=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),e=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,i,this.gl.STATIC_DRAW)},i.setSize=function(t,i){this.width=t,this.height=i,this.gl.canvas.width=this.width,this.gl.canvas.height=this.height,this.gl.viewport(0,0,this.width,this.height)},i.loadFragment=function(t){var i=this;fetch(t).then(function(t){return t.text()}).then(function(t){return i.raw(t)})},i.raw=function(t){this.ready=!1,this.fragments.push(new e(this.gl,t)),this.ready=!0},i.clear=function(t,i,e,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===n&&(n=1),this.gl.clearColor(t,i,e,n),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)},i.render=function(){if(!0===this.ready&&!this.pause){this.clear();for(var t=0;t<this.fragments.length;t++)this.useFragment(this.fragments[t]),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}},t}()});
//# sourceMappingURL=fragments.umd.js.map
